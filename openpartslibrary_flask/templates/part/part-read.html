{% extends "base-row.html" %}


{% block style %}
<!-- Extent the styles here -->
<!-- ... -->
{% endblock style %}

{% block function_buttons %}
<a type="button" class="btn btn-outline-secondary btn-sm" href="{{ url_for('parts') }}" style="font-size: smaller;">
    <img src="{{ url_for('static', filename = 'bootstrap-icons-1.11.3/arrow-left-short.svg') }}" width="20" height="20">All parts
</a>
{% endblock function_buttons %}

{% block view_buttons %}
<!-- Add your view buttons here -->
<!-- ... -->
{% endblock view_buttons %}

{% block main_view_content %}
<div class="container p-3 m-0" style="background-color: white; width: 100%; min-width: 100%; overflow-y: auto;">
   <div class="container-fluid p-3">
    <div class="row">
        <!-- 3D View -->
        <div class="col-4">
            <iframe style="min-width: 100%; min-height: max(100%, 400px); border: 1px solid #dadada;" src="{{ url_for('viewer', filename = part.cad_reference.uuid + '.FCStd') }}"></iframe>
        </div>
        <!-- Properties -->
        <div class="col-8">
            <p>Part</p>
            <h1 class="mb-3">{{ part.name }}</h1>
            <div class="mb-2">
                <nobr>
                    <a type="button" class="btn btn-outline-secondary" style="padding-left: 10px; padding-right: 10px; margin-right: 4px;" href="{{ url_for('run_freecad_gui', filepath = part_cad_filepath) }}"><i class="bi-pencil-square" style="padding-right: 6px;"></i>Edit CAD</a>
                    <a type="button" class="btn btn-outline-secondary" id="liveToastBtn" style="padding-left: 10px; padding-right: 10px; margin-right: 4px;"><i class="bi-pencil-square" style="padding-right: 6px;"></i>Edit Info</a>
                    <a type="button" class="btn btn-outline-danger" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('archive_part', uuid = part.uuid) }}"><i class="bi-x-lg" style="padding-right: 6px;"></i>Archive</a>
                </nobr>
            </div>
            <table class="table table-striped mb-0" style="outline-style: solid; outline-color: lightgray; outline-width: 1px;">
                <tbody>
                    <tr>
                        <td>UUID</td>
                        <td>{{ part.uuid }}</td>
                    </tr>
                    <tr>
                        <td>Name</td>
                        <td>{{ part.name }}</td>
                    </tr>
                    <tr>
                        <td>Description</td>
                        <td>{{ part.description }}</td>
                    </tr>
                    <tr>
                        <td>Part number</td>
                        <td>{{ part.number }}</td>
                    </tr>
                    <tr>
                        <td>Status</td>
                        <td>{{ part.lifecycle_state }}</td>
                    </tr>
                    <tr>
                        <td>Date created</td>
                        <td>{{ part.date_created }}</td>
                    </tr>
                    <tr>
                        <td>Supplier</td>
                        <td>{{ part.supplier.name }}</td>
                    </tr>
                    <tr>
                        <td>Unit price</td>
                        <td>{{ part.unit_price }} {{ part.currency }}</td>
                    </tr>
                </tbody>
            </table>  
        </div>
    </div>
    <h2 class="pt-4">Files</h2>
    <div class="pt-3 mb-2">
        <nobr>
            <a class="btn btn-outline-secondary" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('create_file') }}"><i class="bi-plus-lg" style="padding-right: 6px;"></i>Add file</a>
        </nobr>
    </div>
    <p class="mb-2">{{ len(files) }} files found.</p>
    <table class="table table-striped" style="outline-style: solid; outline-color: lightgray; outline-width: 1px;">
        <thead>
            <tr>
                <th>Name</th>
                <th>Last modified</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for file in files %}
            <tr>
                <td>{{ file.name }}</td>
                <td>{{ file.date_created }}</td>
                <td>
                    <nobr>
                        <a class="btn btn-secondary" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('read_file', file_uuid = file.uuid) }}"><i class="bi-eye"></i></a>
                        <a class="btn btn-outline-secondary" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('update_file', file_uuid = file.uuid) }}"><i class="bi-pencil"></i></a>
                        <a class="btn btn-outline-danger" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('delete_file', file_uuid = file.uuid) }}"><i class="bi-x-lg"></i></a>
                    </nobr>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2 class="pt-4">Used in</h2>

    <p class="mb-2">{{ len(files) }} assemblies found.</p>
    <table class="table table-striped" style="outline-style: solid; outline-color: lightgray; outline-width: 1px;">
        <thead>
            <tr>
                <th>Name</th>
                <th>Last modified</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for file in files %}
            <tr>
                <td>{{ file.name }}</td>
                <td>{{ file.date_created }}</td>
                <td>
                    <nobr>
                        <a class="btn btn-secondary" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('read_file', file_uuid = file.uuid) }}"><i class="bi-eye"></i></a>
                        <a class="btn btn-outline-secondary" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('update_file', file_uuid = file.uuid) }}"><i class="bi-pencil"></i></a>
                        <a class="btn btn-outline-danger" style="padding-left: 10px; padding-right: 10px;" href="{{ url_for('delete_file', file_uuid = file.uuid) }}"><i class="bi-x-lg"></i></a>
                    </nobr>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</div>

{% endblock main_view_content %}

{% block script %}{% endblock script %}